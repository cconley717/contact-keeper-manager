<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact Keeper Manager</title>

    <!-- Styles -->
    <link rel="stylesheet" href="/css/style.css" />

    <!-- AG-Grid JavaScript (includes all CSS) -->
    <script src="/js/ag-grid-community.min.js"></script>
  </head>
  <body>
    <!-- Update Contact Modal -->
    <div id="updateModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Update Contact</h2>
          <button
            type="button"
            class="modal-close"
            onclick="closeUpdateModal()"
            aria-label="Close modal"
          >
            &times;
          </button>
        </div>
        <div class="modal-form-grid">
          <div>
            <label class="form-label" for="updateContactId">Contact ID *</label>
            <input id="updateContactId" class="form-input" 
              type="number"
              min="1"
              step="1"
              required />
          </div>
          <div>
            <label class="form-label" for="updateFirstName">First Name *</label>
            <input type="text" id="updateFirstName" class="form-input" required />
          </div>
          <div>
            <label class="form-label" for="updateLastName">Last Name *</label>
            <input type="text" id="updateLastName" class="form-input" required />
          </div>
          <div>
            <label class="form-label" for="updateProgram">Program</label>
            <input type="text" id="updateProgram" class="form-input" />
          </div>
          <div>
            <label class="form-label" for="updateEmail">Email Address *</label>
            <input type="email" id="updateEmail" class="form-input" required />
          </div>
          <div>
            <label class="form-label" for="updatePhone">Phone</label>
            <input type="tel" id="updatePhone" class="form-input" />
          </div>
          <div>
            <label class="form-label" for="updateLawFirmId">Law Firm ID *</label>
            <input id="updateLawFirmId" class="form-input"
              type="number"
              min="1"
              step="1"
              required
            />
          </div>
          <div>
            <label class="form-label" for="updateLawFirmName">Law Firm Name *</label>
            <input type="text" id="updateLawFirmName" class="form-input" required />
          </div>
          <div>
            <label class="form-label" for="updateCreatedDate">Contact Created Date *</label>
            <input type="text" id="updateCreatedDate" class="form-input" required />
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn-secondary" onclick="closeUpdateModal()">Cancel</button>
          <button class="btn-success" onclick="saveUpdatedContact()">Save Changes</button>
        </div>
      </div>
    </div>

    <div class="container">
      <h1>Contact Keeper Manager</h1>

      <!-- Upload Section -->
      <div class="upload-section">
        <h2>Import CSV File</h2>
        <div class="file-input-wrapper">
          <input type="file" id="csvFile" accept=".csv" />
          <button id="uploadBtn" class="btn-primary">Import</button>
        </div>
        <div id="uploadMessage"></div>
      </div>

      <!-- Download Section -->
      <div class="download-section">
        <h2>Export CSV File</h2>
        <div class="file-input-wrapper">
          <button id="downloadBtn" class="btn-primary">Export</button>
        </div>
        <div id="downloadMessage"></div>
      </div>

      <!-- Add New Contact and Client ID Management (Side-by-Side) -->
      <div class="side-by-side-container">
        <!-- Add New Contact Section -->
        <div class="side-by-side-item">
          <h2 class="collapsible-header" id="addContactToggle">
            <span id="addContactIcon" class="collapsible-icon">▶</span>
            Add New Contact
          </h2>
          <div id="addContactForm" class="collapsible-content">
            <div class="form-grid">
              <div class="form-field">
                <label class="form-label" for="newContactId">Contact ID *</label>
                <input id="newContactId" class="form-input" 
                  type="number"
                  min="1"
                  step="1"
                  required
                />
              </div>
              <div class="form-field">
                <label class="form-label" for="newFirstName">First Name *</label>
                <input type="text" id="newFirstName" class="form-input" required />
              </div>
              <div class="form-field">
                <label class="form-label" for="newLastName">Last Name *</label>
                <input type="text" id="newLastName" class="form-input" required />
              </div>
              <div class="form-field">
                <label class="form-label" for="newProgram">Program</label>
                <input type="text" id="newProgram" class="form-input" />
              </div>
              <div class="form-field">
                <label class="form-label" for="newEmail">Email Address *</label>
                <input type="email" id="newEmail" class="form-input" required />
              </div>
              <div class="form-field">
                <label class="form-label" for="newPhone">Phone</label>
                <input type="text" id="newPhone" class="form-input" />
              </div>
              <div class="form-field">
                <label class="form-label" for="newLawFirmId">Law Firm ID *</label>
                <input id="newLawFirmId" class="form-input"
                  type="number"
                  min="1"
                  step="1"
                  required
                />
              </div>
              <div class="form-field">
                <label class="form-label" for="newLawFirmName">Law Firm Name *</label>
                <input type="text" id="newLawFirmName" class="form-input" required />
              </div>
            </div>
            <button id="addContactBtn" class="btn-success btn-large">Add Contact</button>
            <div id="addContactMessage"></div>
          </div>
        </div>

        <!-- Add Client ID Section -->
        <div class="side-by-side-item">
          <h2 class="collapsible-header" id="addClientToggle">
            <span id="addClientIcon" class="collapsible-icon">▶</span>
            Manage Clients
          </h2>
          <div id="addClientForm" class="collapsible-content">
            <div class="form-grid">
              <div class="form-field">
                <label class="form-label" for="newClientIdInput">Client ID *</label>
                <input id="newClientIdInput" class="form-input"
                  type="number"
                  min="1"
                  step="1"
                  required
                />
              </div>
              <div class="form-field">
                <label class="form-label" for="newClientNameInput">Client Name *</label>
                <input type="text" id="newClientNameInput" class="form-input" required />
              </div>
            </div>
            <button id="addClientIdBtn" class="btn-success btn-large">Add Client</button>

            <div class="client-csv-actions">
              <input type="file" id="clientCsvFile" accept=".csv" class="hidden" />
              <button id="importClientCsvBtn" class="btn-primary btn-large">Import</button>
              <button id="exportClientCsvBtn" class="btn-primary btn-large">Export</button>
            </div>

            <div id="clientCsvMessage"></div>

            <div id="addClientMessage"></div>

            <!-- List of existing client IDs -->
            <div id="clientIdList" class="client-list"></div>
          </div>
        </div>
      </div>

      <!-- Data Grid Section -->
      <div class="grid-section">
        <h2>Contact Database</h2>
        <div class="search-bar">
          <input
            type="text"
            id="searchInput"
            class="search-input"
            placeholder="Search across all columns..."
            autocomplete="off"
          />
          <button id="searchBtn" class="btn-primary ml-10">Search</button>
          <button id="clearSearchBtn" class="btn-secondary ml-5">Clear</button>
        </div>
        <div id="dataGrid"></div>
      </div>

      <!-- Output Table Section -->
      <div class="output-section">
        <div class="output-header">
          <h2 class="output-header__title">Output Table</h2>
        </div>
        <table class="output-table">
          <tbody>
            <tr>
              <th>Client ID</th>
              <td><select data-field="client_id" id="outputClientIdSelect"></select></td>
            </tr>
            <tr>
              <th>Contact ID</th>
              <td><input type="text" data-field="contact_id" /></td>
            </tr>
            <tr>
              <th>Topic</th>
              <td>
                <select data-field="topic">
                  <option value=""></option>
                  <option value="General Information">General Information</option>
                  <option value="Payment Information">Payment Information</option>
                  <option value="Portal Navigation">Portal Navigation</option>
                  <option value="EIF Question">EIF Question</option>
                  <option value="EPP Question">EPP Question</option>
                  <option value="FIFO Question">FIFO Question</option>
                  <option value="DPP Question">DPP Question</option>
                  <option value="Bankruptcy Question">Bankruptcy Question</option>
                  <option value="Liens Question">Liens Question</option>
                  <option value="Consortium Question">Consortium Question</option>
                  <option value="Ledgering Question">Ledgering Question</option>
                  <option value="Report Question">Report Question</option>
                  <option value="Attorney Representation Related">
                    Attorney Representation Related
                  </option>
                  <option value="Notice Question">Notice Question</option>
                  <option value="Duplicate Claimant">Duplicate Claimant</option>
                  <option value="Portal Access">Portal Access</option>
                  <option value="Representative Claimant List">Representative Claimant List</option>
                </select>
              </td>
            </tr>
            <tr>
              <th>Firm ID(s)</th>
              <td><input type="number" data-field="law_firm_id" min="1" step="1" /></td>
            </tr>
            <tr>
              <th>Claimant ID(s)</th>
              <td><input type="text" data-field="claimant_id" /></td>
            </tr>
            <tr>
              <th>Inbound/Outbound</th>
              <td>
                <select data-field="inbound_outbound">
                  <option value=""></option>
                  <option value="Inbound">Inbound</option>
                  <option value="Outbound">Outbound</option>
                </select>
              </td>
            </tr>
            <tr>
              <th>Outreach</th>
              <td>
                <select data-field="outreach">
                  <option value=""></option>
                  <option value="Yes">Yes</option>
                  <option value="No">No</option>
                </select>
              </td>
            </tr>
            <tr>
              <th>Communication Method</th>
              <td>
                <select data-field="communication_method">
                  <option value=""></option>
                  <option value="Email">Email</option>
                </select>
              </td>
            </tr>
            <tr>
              <th>Start of Message:</th>
              <td><input type="text" data-field="message" /></td>
            </tr>
          </tbody>
        </table>
      </div>
      <br />
      <button id="copyOutputBtn" class="btn-info">Copy to Clipboard</button>
    </div>

    <script type="module" src="/js/app.js"></script>
  </body>
</html>
